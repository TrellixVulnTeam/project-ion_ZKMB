<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>APM:Libraries: libraries/AP_ICEngine/AP_ICEngine.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_eecdb3b7edc378c3b87f1df0443878bf.html">AP_ICEngine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AP_ICEngine.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AP__ICEngine_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">   This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">   the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">   (at your option) any later version.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">   GNU General Public License for more details.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="SRV__Channel_8h.html">SRV_Channel/SRV_Channel.h</a>&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="GCS_8h.html">GCS_MAVLink/GCS.h</a>&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__ICEngine_8h.html">AP_ICEngine.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="AP__ICEngine_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">const</span> <a class="code" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code" href="classAP__ICEngine.html#a44fe9a8e0d8890b3c722e5dd83ec2aa9">AP_ICEngine::var_info</a>[] = {</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">// @Param: ENABLE</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// @DisplayName: Enable ICEngine control</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">// @Description: This enables internal combusion engine control</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">// @Values: 0:Disabled, 1:Enabled</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="AP__Param_8h.html#ac24e2eb16c2194e975d27e47ddcb7f1c">AP_GROUPINFO_FLAGS</a>(<span class="stringliteral">&quot;ENABLE&quot;</span>, 0, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, enable, 0, <a class="code" href="AP__Param_8h.html#ae25c1c7495435989f8be5781c86be078">AP_PARAM_FLAG_ENABLE</a>),</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// @Param: START_CHAN</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// @DisplayName: Input channel for engine start</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// @Description: This is an RC input channel for requesting engine start. Engine will try to start when channel is at or above 1700. Engine will stop when channel is at or below 1300. Between 1301 and 1699 the engine will not change state unless a MAVLink command or mission item commands a state change, or the vehicle is disamed.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// @Values: 0:None,1:Chan1,2:Chan2,3:Chan3,4:Chan4,5:Chan5,6:Chan6,7:Chan7,8:Chan8,9:Chan9,10:Chan10,11:Chan11,12:Chan12,13:Chan13,14:Chan14,15:Chan15,16:Chan16</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;START_CHAN&quot;</span>, 1, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, start_chan, 0),</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// @Param: STARTER_TIME</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// @DisplayName: Time to run starter</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// @Description: This is the number of seconds to run the starter when trying to start the engine</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// @Units: Seconds</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// @Range: 0.1 5</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;STARTER_TIME&quot;</span>, 2, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, starter_time, 3),</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// @Param: START_DELAY</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// @DisplayName: Time to wait between starts</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// @Description: Delay between start attempts</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// @Units: Seconds</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// @Range: 1 10</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;START_DELAY&quot;</span>, 3, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, starter_delay, 2),</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// @Param: RPM_THRESH</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// @DisplayName: RPM threshold</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// @Description: This is the measured RPM above which tne engine is considered to be running</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// @Range: 100 100000</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;RPM_THRESH&quot;</span>, 4, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, rpm_threshold, 100),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// @Param: PWM_IGN_ON</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// @DisplayName: PWM value for ignition on</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// @Description: This is the value sent to the ignition channel when on</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// @Range: 1000 2000</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;PWM_IGN_ON&quot;</span>, 5, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, pwm_ignition_on, 2000),</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// @Param: PWM_IGN_OFF</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// @DisplayName: PWM value for ignition off</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// @Description: This is the value sent to the ignition channel when off</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// @Range: 1000 2000</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;PWM_IGN_OFF&quot;</span>, 6, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, pwm_ignition_off, 1000),</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// @Param: PWM_STRT_ON</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// @DisplayName: PWM value for starter on</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// @Description: This is the value sent to the starter channel when on</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// @Range: 1000 2000</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;PWM_STRT_ON&quot;</span>, 7, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, pwm_starter_on, 2000),</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// @Param: PWM_STRT_OFF</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// @DisplayName: PWM value for starter off</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// @Description: This is the value sent to the starter channel when off</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// @Range: 1000 2000</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;PWM_STRT_OFF&quot;</span>, 8, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, pwm_starter_off, 1000),</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// @Param: RPM_CHAN</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// @DisplayName: RPM instance channel to use</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// @Description: This is which of the RPM instances to use for detecting the RPM of the engine</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// @Values: 0:None,1:RPM1,2:RPM2</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;RPM_CHAN&quot;</span>,  9, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, rpm_instance, 0),</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// @Param: START_PCT</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// @DisplayName: Throttle percentage for engine start</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// @Description: This is the percentage throttle output for engine start</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// @Range: 0 100</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;START_PCT&quot;</span>, 10, <a class="code" href="classAP__ICEngine.html">AP_ICEngine</a>, start_percent, 5),</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a>    </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;};</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">// constructor</span></div><div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classAP__ICEngine.html#a99fd9520341de1b4a4145e16a3f0aa28">  109</a></span>&#160;<a class="code" href="classAP__ICEngine.html#a99fd9520341de1b4a4145e16a3f0aa28">AP_ICEngine::AP_ICEngine</a>(<span class="keyword">const</span> <a class="code" href="classAP__RPM.html">AP_RPM</a> &amp;_rpm, <span class="keyword">const</span> <a class="code" href="classAP__AHRS.html">AP_AHRS</a> &amp;_ahrs) :</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    rpm(_rpm),</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="ModuleTest_8cpp.html#a0a15280249072432f8c559cc00d09dee">ahrs</a>(_ahrs),</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="Linux_2Util_8cpp.html#a89f234133d3efe315836311cbf21c64b">state</a>(ICE_OFF)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, <a class="code" href="classAP__ICEngine.html#a44fe9a8e0d8890b3c722e5dd83ec2aa9">var_info</a>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">  update engine state</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="classAP__ICEngine.html#a72c0687138bdfde2f905f00be039b710">  120</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__ICEngine.html#a72c0687138bdfde2f905f00be039b710">AP_ICEngine::update</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;{</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classAP__ICEngine.html#a3b636c3789b124d18c8ec6102a46e294">enable</a>) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    uint16_t cvalue = 1500;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#ab5fea2c005e803691ede6a31acaba2f8">start_chan</a> != 0) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="comment">// get starter control channel</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        cvalue = hal.<a class="code" href="classAP__HAL_1_1HAL.html#a44ed5c21ed9aae558cff53d73c3714b5">rcin</a>-&gt;<a class="code" href="classAP__HAL_1_1RCInput.html#a078fd7e6d2e6a899009ec674a8e03498">read</a>(<a class="code" href="classAP__ICEngine.html#ab5fea2c005e803691ede6a31acaba2f8">start_chan</a>-1);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">bool</span> should_run = <span class="keyword">false</span>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    uint32_t now = <a class="code" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> == <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a> &amp;&amp; cvalue &gt;= 1700) {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        should_run = <span class="keyword">true</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cvalue &lt;= 1300) {</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        should_run = <span class="keyword">false</span>;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> != <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        should_run = <span class="keyword">true</span>;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// switch on current state to work out new state</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a>) {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>:</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span> (should_run) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea6c6f711f18a620ba39d0215d396d1c59">ICE_START_DELAY</a>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eadc052604e13414f786fd43c37c622c92">ICE_START_HEIGHT_DELAY</a>: {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="classVector3.html">Vector3f</a> pos;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> (!should_run) {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#a45ed12a70087adbae9c4e18698827936">ahrs</a>.<a class="code" href="classAP__AHRS.html#ae38fa74d7c786afb8bad87d9a2a16bfd">get_relative_position_NED_origin</a>(pos)) {</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#a416eeeb7e22a4b3b7c927cf7409d4a43">height_pending</a>) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <a class="code" href="classAP__ICEngine.html#a416eeeb7e22a4b3b7c927cf7409d4a43">height_pending</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                <a class="code" href="classAP__ICEngine.html#a0f40d24501ea23ca9d860351f084ca17">initial_height</a> = -pos.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((-pos.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>) &gt;= <a class="code" href="classAP__ICEngine.html#a0f40d24501ea23ca9d860351f084ca17">initial_height</a> + <a class="code" href="classAP__ICEngine.html#a5ccd39797b09456f6b6257541483cdd0">height_required</a>) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <a class="code" href="classGCS__MAVLINK.html#ae1d5ebd46ec3ddb644862c747e2968bf">GCS_MAVLINK::send_statustext_all</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;Starting height reached %.1f&quot;</span>,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                 (<span class="keywordtype">double</span>)(-pos.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> - <a class="code" href="classAP__ICEngine.html#a0f40d24501ea23ca9d860351f084ca17">initial_height</a>));</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea73eead72ca890d2fe2ae8065d57c5b47">ICE_STARTING</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea6c6f711f18a620ba39d0215d396d1c59">ICE_START_DELAY</a>:</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">if</span> (!should_run) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (now - <a class="code" href="classAP__ICEngine.html#ae68f765382e16bf7f797f756bd8ab71b">starter_last_run_ms</a> &gt;= <a class="code" href="classAP__ICEngine.html#a346918729b138929cb938df5173e34a1">starter_delay</a>*1000) {</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <a class="code" href="classGCS__MAVLINK.html#ae1d5ebd46ec3ddb644862c747e2968bf">GCS_MAVLINK::send_statustext_all</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;Starting engine&quot;</span>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea73eead72ca890d2fe2ae8065d57c5b47">ICE_STARTING</a>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea73eead72ca890d2fe2ae8065d57c5b47">ICE_STARTING</a>:</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> (!should_run) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (now - <a class="code" href="classAP__ICEngine.html#ae82f2816e4edc65615219d25c0322dcb">starter_start_time_ms</a> &gt;= <a class="code" href="classAP__ICEngine.html#a4cbc352541d1ca74ae9047714e77cf54">starter_time</a>*1000) {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eab7a045bcfc9d7088d41ac1c8468ceb77">ICE_RUNNING</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eab7a045bcfc9d7088d41ac1c8468ceb77">ICE_RUNNING</a>:</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (!should_run) {</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <a class="code" href="classGCS__MAVLINK.html#ae1d5ebd46ec3ddb644862c747e2968bf">GCS_MAVLINK::send_statustext_all</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;Stopped engine&quot;</span>);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#a80078ed6dec0ef6cd26dbd6d57ff5585">rpm_instance</a> &gt; 0) {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="comment">// check RPM to see if still running</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classAP__ICEngine.html#a9f008c7be373a380dc7be8e9554e88aa">rpm</a>.<a class="code" href="classAP__RPM.html#abc56e8f9ca5bfb3c35d8e01f819913c3">healthy</a>(<a class="code" href="classAP__ICEngine.html#a80078ed6dec0ef6cd26dbd6d57ff5585">rpm_instance</a>-1) ||</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <a class="code" href="classAP__ICEngine.html#a9f008c7be373a380dc7be8e9554e88aa">rpm</a>.<a class="code" href="classAP__RPM.html#a4b9cd90c826c653f19d6f76571ed202a">get_rpm</a>(<a class="code" href="classAP__ICEngine.html#a80078ed6dec0ef6cd26dbd6d57ff5585">rpm_instance</a>-1) &lt; <a class="code" href="classAP__ICEngine.html#adb569382b60f51f593d51e94807f47c2">rpm_threshold</a>) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="comment">// engine has stopped when it should be running</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea6c6f711f18a620ba39d0215d396d1c59">ICE_START_DELAY</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (!hal.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a973ee89f8eee7af3a4d2a3eb700cbf3c">get_soft_armed</a>()) {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> == <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eadc052604e13414f786fd43c37c622c92">ICE_START_HEIGHT_DELAY</a>) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">// when disarmed we can be waiting for takeoff</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="classVector3.html">Vector3f</a> pos;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#a45ed12a70087adbae9c4e18698827936">ahrs</a>.<a class="code" href="classAP__AHRS.html#ae38fa74d7c786afb8bad87d9a2a16bfd">get_relative_position_NED_origin</a>(pos)) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="comment">// reset initial height while disarmed</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                <a class="code" href="classAP__ICEngine.html#a0f40d24501ea23ca9d860351f084ca17">initial_height</a> = -pos.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="comment">// force ignition off when disarmed</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    </div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">/* now set output channels */</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a>) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>:</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a>(<a class="code" href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a722f4cff8c7bcd4e2825ab4b977d2fdf">SRV_Channel::k_ignition</a>, <a class="code" href="classAP__ICEngine.html#a85cd863863fa1a373a9bc3c57611aadf">pwm_ignition_off</a>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a>(<a class="code" href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a74b4c481896ab920a1185557733423a6">SRV_Channel::k_starter</a>,  <a class="code" href="classAP__ICEngine.html#ae2b7a31fff3fe5d7f62bd05bbbcd211a">pwm_starter_off</a>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="classAP__ICEngine.html#ae82f2816e4edc65615219d25c0322dcb">starter_start_time_ms</a> = 0;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eadc052604e13414f786fd43c37c622c92">ICE_START_HEIGHT_DELAY</a>:</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea6c6f711f18a620ba39d0215d396d1c59">ICE_START_DELAY</a>:</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a>(<a class="code" href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a722f4cff8c7bcd4e2825ab4b977d2fdf">SRV_Channel::k_ignition</a>, <a class="code" href="classAP__ICEngine.html#af8f955ce6d7bc408b06bcd1643de98d3">pwm_ignition_on</a>);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a>(<a class="code" href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a74b4c481896ab920a1185557733423a6">SRV_Channel::k_starter</a>,  <a class="code" href="classAP__ICEngine.html#ae2b7a31fff3fe5d7f62bd05bbbcd211a">pwm_starter_off</a>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea73eead72ca890d2fe2ae8065d57c5b47">ICE_STARTING</a>:</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a>(<a class="code" href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a722f4cff8c7bcd4e2825ab4b977d2fdf">SRV_Channel::k_ignition</a>, <a class="code" href="classAP__ICEngine.html#af8f955ce6d7bc408b06bcd1643de98d3">pwm_ignition_on</a>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a>(<a class="code" href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a74b4c481896ab920a1185557733423a6">SRV_Channel::k_starter</a>,  <a class="code" href="classAP__ICEngine.html#abaa30520c4ee51243f978d0676f0518c">pwm_starter_on</a>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#ae82f2816e4edc65615219d25c0322dcb">starter_start_time_ms</a> == 0) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <a class="code" href="classAP__ICEngine.html#ae82f2816e4edc65615219d25c0322dcb">starter_start_time_ms</a> = now;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        }</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="classAP__ICEngine.html#ae68f765382e16bf7f797f756bd8ab71b">starter_last_run_ms</a> = now;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eab7a045bcfc9d7088d41ac1c8468ceb77">ICE_RUNNING</a>:</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a>(<a class="code" href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a722f4cff8c7bcd4e2825ab4b977d2fdf">SRV_Channel::k_ignition</a>, <a class="code" href="classAP__ICEngine.html#af8f955ce6d7bc408b06bcd1643de98d3">pwm_ignition_on</a>);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a>(<a class="code" href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a74b4c481896ab920a1185557733423a6">SRV_Channel::k_starter</a>,  <a class="code" href="classAP__ICEngine.html#ae2b7a31fff3fe5d7f62bd05bbbcd211a">pwm_starter_off</a>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="classAP__ICEngine.html#ae82f2816e4edc65615219d25c0322dcb">starter_start_time_ms</a> = 0;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">  check for throttle override. This allows the ICE controller to force</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">  the correct starting throttle when starting the engine</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="classAP__ICEngine.html#a0053087a719317c128ff98b1b1fec0ab">  250</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__ICEngine.html#a0053087a719317c128ff98b1b1fec0ab">AP_ICEngine::throttle_override</a>(uint8_t &amp;percentage)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classAP__ICEngine.html#a3b636c3789b124d18c8ec6102a46e294">enable</a>) {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> == <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea73eead72ca890d2fe2ae8065d57c5b47">ICE_STARTING</a> || <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> == <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea6c6f711f18a620ba39d0215d396d1c59">ICE_START_DELAY</a>) {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        percentage = (uint8_t)<a class="code" href="classAP__ICEngine.html#a5aabdc12cb572bb8c433b7c41c025470">start_percent</a>.get();</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;}</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">  handle DO_ENGINE_CONTROL messages via MAVLink or mission</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classAP__ICEngine.html#a7ff9bcb99673c2fdd18f017902759fdc">  266</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__ICEngine.html#a7ff9bcb99673c2fdd18f017902759fdc">AP_ICEngine::engine_control</a>(<span class="keywordtype">float</span> start_control, <span class="keywordtype">float</span> cold_start, <span class="keywordtype">float</span> height_delay)</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;{</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (start_control &lt;= 0) {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">ICE_OFF</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__ICEngine.html#ab5fea2c005e803691ede6a31acaba2f8">start_chan</a> != 0) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// get starter control channel</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">if</span> (hal.<a class="code" href="classAP__HAL_1_1HAL.html#a44ed5c21ed9aae558cff53d73c3714b5">rcin</a>-&gt;<a class="code" href="classAP__HAL_1_1RCInput.html#a078fd7e6d2e6a899009ec674a8e03498">read</a>(<a class="code" href="classAP__ICEngine.html#ab5fea2c005e803691ede6a31acaba2f8">start_chan</a>-1) &lt;= 1300) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <a class="code" href="classGCS__MAVLINK.html#ae1d5ebd46ec3ddb644862c747e2968bf">GCS_MAVLINK::send_statustext_all</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;Engine: start control disabled&quot;</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">if</span> (height_delay &gt; 0) {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="classAP__ICEngine.html#a416eeeb7e22a4b3b7c927cf7409d4a43">height_pending</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="classAP__ICEngine.html#a0f40d24501ea23ca9d860351f084ca17">initial_height</a> = 0;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="classAP__ICEngine.html#a5ccd39797b09456f6b6257541483cdd0">height_required</a> = height_delay;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eadc052604e13414f786fd43c37c622c92">ICE_START_HEIGHT_DELAY</a>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="classGCS__MAVLINK.html#ae1d5ebd46ec3ddb644862c747e2968bf">GCS_MAVLINK::send_statustext_all</a>(MAV_SEVERITY_INFO, <span class="stringliteral">&quot;Takeoff height set to %.1fm&quot;</span>, (<span class="keywordtype">double</span>)height_delay);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">state</a> = <a class="code" href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea73eead72ca890d2fe2ae8065d57c5b47">ICE_STARTING</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;}</div><div class="ttc" id="classAP__ICEngine_html_a0f40d24501ea23ca9d860351f084ca17"><div class="ttname"><a href="classAP__ICEngine.html#a0f40d24501ea23ca9d860351f084ca17">AP_ICEngine::initial_height</a></div><div class="ttdeci">float initial_height</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00091">AP_ICEngine.h:91</a></div></div>
<div class="ttc" id="classAP__RPM_html_abc56e8f9ca5bfb3c35d8e01f819913c3"><div class="ttname"><a href="classAP__RPM.html#abc56e8f9ca5bfb3c35d8e01f819913c3">AP_RPM::healthy</a></div><div class="ttdeci">bool healthy(uint8_t instance) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__RPM_8cpp_source.html#l00157">AP_RPM.cpp:157</a></div></div>
<div class="ttc" id="classSRV__Channel_html_a9ca1754fc905dddeebec41568a475d68a722f4cff8c7bcd4e2825ab4b977d2fdf"><div class="ttname"><a href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a722f4cff8c7bcd4e2825ab4b977d2fdf">SRV_Channel::k_ignition</a></div><div class="ttdef"><b>Definition:</b> <a href="SRV__Channel_8h_source.html#l00098">SRV_Channel.h:98</a></div></div>
<div class="ttc" id="AP__Param_8h_html_ae25c1c7495435989f8be5781c86be078"><div class="ttname"><a href="AP__Param_8h.html#ae25c1c7495435989f8be5781c86be078">AP_PARAM_FLAG_ENABLE</a></div><div class="ttdeci">#define AP_PARAM_FLAG_ENABLE</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00046">AP_Param.h:46</a></div></div>
<div class="ttc" id="classGCS__MAVLINK_html_ae1d5ebd46ec3ddb644862c747e2968bf"><div class="ttname"><a href="classGCS__MAVLINK.html#ae1d5ebd46ec3ddb644862c747e2968bf">GCS_MAVLINK::send_statustext_all</a></div><div class="ttdeci">static void send_statustext_all(MAV_SEVERITY severity, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="GCS__Common_8cpp_source.html#l01322">GCS_Common.cpp:1322</a></div></div>
<div class="ttc" id="classSRV__Channel_html_a9ca1754fc905dddeebec41568a475d68a74b4c481896ab920a1185557733423a6"><div class="ttname"><a href="classSRV__Channel.html#a9ca1754fc905dddeebec41568a475d68a74b4c481896ab920a1185557733423a6">SRV_Channel::k_starter</a></div><div class="ttdef"><b>Definition:</b> <a href="SRV__Channel_8h_source.html#l00100">SRV_Channel.h:100</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a346918729b138929cb938df5173e34a1"><div class="ttname"><a href="classAP__ICEngine.html#a346918729b138929cb938df5173e34a1">AP_ICEngine::starter_delay</a></div><div class="ttdeci">AP_Float starter_delay</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00070">AP_ICEngine.h:70</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a45ed12a70087adbae9c4e18698827936"><div class="ttname"><a href="classAP__ICEngine.html#a45ed12a70087adbae9c4e18698827936">AP_ICEngine::ahrs</a></div><div class="ttdeci">const AP_AHRS &amp; ahrs</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00053">AP_ICEngine.h:53</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ab417dbbac7557b327b5ededdaed46c0eab7a045bcfc9d7088d41ac1c8468ceb77"><div class="ttname"><a href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eab7a045bcfc9d7088d41ac1c8468ceb77">AP_ICEngine::ICE_RUNNING</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00042">AP_ICEngine.h:42</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_abaa30520c4ee51243f978d0676f0518c"><div class="ttname"><a href="classAP__ICEngine.html#abaa30520c4ee51243f978d0676f0518c">AP_ICEngine::pwm_starter_on</a></div><div class="ttdeci">AP_Int16 pwm_starter_on</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00075">AP_ICEngine.h:75</a></div></div>
<div class="ttc" id="GCS_8h_html"><div class="ttname"><a href="GCS_8h.html">GCS.h</a></div><div class="ttdoc">Interface definition for the various Ground Control System. </div></div>
<div class="ttc" id="AP__ICEngine_8h_html"><div class="ttname"><a href="AP__ICEngine_8h.html">AP_ICEngine.h</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a416eeeb7e22a4b3b7c927cf7409d4a43"><div class="ttname"><a href="classAP__ICEngine.html#a416eeeb7e22a4b3b7c927cf7409d4a43">AP_ICEngine::height_pending</a></div><div class="ttdeci">bool height_pending</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00097">AP_ICEngine.h:97</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a0053087a719317c128ff98b1b1fec0ab"><div class="ttname"><a href="classAP__ICEngine.html#a0053087a719317c128ff98b1b1fec0ab">AP_ICEngine::throttle_override</a></div><div class="ttdeci">bool throttle_override(uint8_t &amp;percent)</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8cpp_source.html#l00250">AP_ICEngine.cpp:250</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a78a408c84f2a1bafde256ac650142e4d"><div class="ttname"><a href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, clazz, element, def)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00087">AP_Param.h:87</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a85cd863863fa1a373a9bc3c57611aadf"><div class="ttname"><a href="classAP__ICEngine.html#a85cd863863fa1a373a9bc3c57611aadf">AP_ICEngine::pwm_ignition_off</a></div><div class="ttdeci">AP_Int16 pwm_ignition_off</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00074">AP_ICEngine.h:74</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a9337a60383f4264fa96a20dbe43a4e2e"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">AP_HAL::HAL::util</a></div><div class="ttdeci">AP_HAL::Util * util</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00094">HAL.h:94</a></div></div>
<div class="ttc" id="AP__ICEngine_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__ICEngine_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8cpp_source.html#l00010">AC_PID_test.cpp:10</a></div></div>
<div class="ttc" id="classAP__AHRS_html"><div class="ttname"><a href="classAP__AHRS.html">AP_AHRS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00050">AP_AHRS.h:50</a></div></div>
<div class="ttc" id="classAP__HAL_1_1RCInput_html_a078fd7e6d2e6a899009ec674a8e03498"><div class="ttname"><a href="classAP__HAL_1_1RCInput.html#a078fd7e6d2e6a899009ec674a8e03498">AP_HAL::RCInput::read</a></div><div class="ttdeci">virtual uint16_t read(uint8_t ch)=0</div></div>
<div class="ttc" id="classAP__ICEngine_html_a44fe9a8e0d8890b3c722e5dd83ec2aa9"><div class="ttname"><a href="classAP__ICEngine.html#a44fe9a8e0d8890b3c722e5dd83ec2aa9">AP_ICEngine::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00029">AP_ICEngine.h:29</a></div></div>
<div class="ttc" id="ModuleTest_8cpp_html_a0a15280249072432f8c559cc00d09dee"><div class="ttname"><a href="ModuleTest_8cpp.html#a0a15280249072432f8c559cc00d09dee">ahrs</a></div><div class="ttdeci">AP_AHRS_DCM ahrs(ins, baro, gps)</div></div>
<div class="ttc" id="AP__Param_8h_html_ac24e2eb16c2194e975d27e47ddcb7f1c"><div class="ttname"><a href="AP__Param_8h.html#ac24e2eb16c2194e975d27e47ddcb7f1c">AP_GROUPINFO_FLAGS</a></div><div class="ttdeci">#define AP_GROUPINFO_FLAGS(name, idx, clazz, element, def, flags)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00078">AP_Param.h:78</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ab5fea2c005e803691ede6a31acaba2f8"><div class="ttname"><a href="classAP__ICEngine.html#ab5fea2c005e803691ede6a31acaba2f8">AP_ICEngine::start_chan</a></div><div class="ttdeci">AP_Int8 start_chan</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00061">AP_ICEngine.h:61</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ab417dbbac7557b327b5ededdaed46c0eadc052604e13414f786fd43c37c622c92"><div class="ttname"><a href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0eadc052604e13414f786fd43c37c622c92">AP_ICEngine::ICE_START_HEIGHT_DELAY</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00039">AP_ICEngine.h:39</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00018">HAL.h:18</a></div></div>
<div class="ttc" id="classAP__ICEngine_html"><div class="ttname"><a href="classAP__ICEngine.html">AP_ICEngine</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00024">AP_ICEngine.h:24</a></div></div>
<div class="ttc" id="classSRV__Channels_html_a6ec155ae75e3d22a0de00e21e5b330a9"><div class="ttname"><a href="classSRV__Channels.html#a6ec155ae75e3d22a0de00e21e5b330a9">SRV_Channels::set_output_pwm</a></div><div class="ttdeci">static void set_output_pwm(SRV_Channel::Aux_servo_function_t function, uint16_t value)</div><div class="ttdef"><b>Definition:</b> <a href="SRV__Channel__aux_8cpp_source.html#l00161">SRV_Channel_aux.cpp:161</a></div></div>
<div class="ttc" id="namespaceAP__HAL_html_a77dffbb18891996280308e21316ec186"><div class="ttname"><a href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a></div><div class="ttdeci">uint32_t millis()</div><div class="ttdef"><b>Definition:</b> <a href="AP__HAL__Linux_2system_8cpp_source.html#l00043">system.cpp:43</a></div></div>
<div class="ttc" id="classAP__RPM_html"><div class="ttname"><a href="classAP__RPM.html">AP_RPM</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__RPM_8h_source.html#l00027">AP_RPM.h:27</a></div></div>
<div class="ttc" id="classVector3_html_ab3e7f5401dd6e951978bfa746809f74f"><div class="ttname"><a href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">Vector3::z</a></div><div class="ttdeci">T z</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00067">vector3.h:67</a></div></div>
<div class="ttc" id="structAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00126">AP_Param.h:126</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ae68f765382e16bf7f797f756bd8ab71b"><div class="ttname"><a href="classAP__ICEngine.html#ae68f765382e16bf7f797f756bd8ab71b">AP_ICEngine::starter_last_run_ms</a></div><div class="ttdeci">uint32_t starter_last_run_ms</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00085">AP_ICEngine.h:85</a></div></div>
<div class="ttc" id="Linux_2Util_8cpp_html_a89f234133d3efe315836311cbf21c64b"><div class="ttname"><a href="Linux_2Util_8cpp.html#a89f234133d3efe315836311cbf21c64b">state</a></div><div class="ttdeci">static int state</div><div class="ttdef"><b>Definition:</b> <a href="Linux_2Util_8cpp_source.html#l00021">Util.cpp:21</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a5ccd39797b09456f6b6257541483cdd0"><div class="ttname"><a href="classAP__ICEngine.html#a5ccd39797b09456f6b6257541483cdd0">AP_ICEngine::height_required</a></div><div class="ttdeci">float height_required</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00094">AP_ICEngine.h:94</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ae2b7a31fff3fe5d7f62bd05bbbcd211a"><div class="ttname"><a href="classAP__ICEngine.html#ae2b7a31fff3fe5d7f62bd05bbbcd211a">AP_ICEngine::pwm_starter_off</a></div><div class="ttdeci">AP_Int16 pwm_starter_off</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00076">AP_ICEngine.h:76</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1"><div class="ttname"><a href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea0689148093af2b40bd95ddb6cd4569a1">AP_ICEngine::ICE_OFF</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00038">AP_ICEngine.h:38</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ab417dbbac7557b327b5ededdaed46c0ea73eead72ca890d2fe2ae8065d57c5b47"><div class="ttname"><a href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea73eead72ca890d2fe2ae8065d57c5b47">AP_ICEngine::ICE_STARTING</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00041">AP_ICEngine.h:41</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a3b636c3789b124d18c8ec6102a46e294"><div class="ttname"><a href="classAP__ICEngine.html#a3b636c3789b124d18c8ec6102a46e294">AP_ICEngine::enable</a></div><div class="ttdeci">AP_Int8 enable</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00058">AP_ICEngine.h:58</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a4cbc352541d1ca74ae9047714e77cf54"><div class="ttname"><a href="classAP__ICEngine.html#a4cbc352541d1ca74ae9047714e77cf54">AP_ICEngine::starter_time</a></div><div class="ttdeci">AP_Float starter_time</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00067">AP_ICEngine.h:67</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_acea80153691d4a8e4aaa9e3ba6220828"><div class="ttname"><a href="classAP__ICEngine.html#acea80153691d4a8e4aaa9e3ba6220828">AP_ICEngine::state</a></div><div class="ttdeci">enum ICE_State state</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00055">AP_ICEngine.h:55</a></div></div>
<div class="ttc" id="classAP__RPM_html_a4b9cd90c826c653f19d6f76571ed202a"><div class="ttname"><a href="classAP__RPM.html#a4b9cd90c826c653f19d6f76571ed202a">AP_RPM::get_rpm</a></div><div class="ttdeci">float get_rpm(uint8_t instance) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__RPM_8h_source.html#l00073">AP_RPM.h:73</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a9f008c7be373a380dc7be8e9554e88aa"><div class="ttname"><a href="classAP__ICEngine.html#a9f008c7be373a380dc7be8e9554e88aa">AP_ICEngine::rpm</a></div><div class="ttdeci">const AP_RPM &amp; rpm</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00052">AP_ICEngine.h:52</a></div></div>
<div class="ttc" id="classVector3_html"><div class="ttname"><a href="classVector3.html">Vector3&lt; float &gt;</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a80078ed6dec0ef6cd26dbd6d57ff5585"><div class="ttname"><a href="classAP__ICEngine.html#a80078ed6dec0ef6cd26dbd6d57ff5585">AP_ICEngine::rpm_instance</a></div><div class="ttdeci">AP_Int8 rpm_instance</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00064">AP_ICEngine.h:64</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a5aabdc12cb572bb8c433b7c41c025470"><div class="ttname"><a href="classAP__ICEngine.html#a5aabdc12cb572bb8c433b7c41c025470">AP_ICEngine::start_percent</a></div><div class="ttdeci">AP_Int8 start_percent</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00088">AP_ICEngine.h:88</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ae82f2816e4edc65615219d25c0322dcb"><div class="ttname"><a href="classAP__ICEngine.html#ae82f2816e4edc65615219d25c0322dcb">AP_ICEngine::starter_start_time_ms</a></div><div class="ttdeci">uint32_t starter_start_time_ms</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00082">AP_ICEngine.h:82</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_af8f955ce6d7bc408b06bcd1643de98d3"><div class="ttname"><a href="classAP__ICEngine.html#af8f955ce6d7bc408b06bcd1643de98d3">AP_ICEngine::pwm_ignition_on</a></div><div class="ttdeci">AP_Int16 pwm_ignition_on</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00073">AP_ICEngine.h:73</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a44ed5c21ed9aae558cff53d73c3714b5"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a44ed5c21ed9aae558cff53d73c3714b5">AP_HAL::HAL::rcin</a></div><div class="ttdeci">AP_HAL::RCInput * rcin</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00091">HAL.h:91</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a72c0687138bdfde2f905f00be039b710"><div class="ttname"><a href="classAP__ICEngine.html#a72c0687138bdfde2f905f00be039b710">AP_ICEngine::update</a></div><div class="ttdeci">void update(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8cpp_source.html#l00120">AP_ICEngine.cpp:120</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a99fd9520341de1b4a4145e16a3f0aa28"><div class="ttname"><a href="classAP__ICEngine.html#a99fd9520341de1b4a4145e16a3f0aa28">AP_ICEngine::AP_ICEngine</a></div><div class="ttdeci">AP_ICEngine(const AP_RPM &amp;_rpm, const AP_AHRS &amp;_ahrs)</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8cpp_source.html#l00109">AP_ICEngine.cpp:109</a></div></div>
<div class="ttc" id="classAP__AHRS_html_ae38fa74d7c786afb8bad87d9a2a16bfd"><div class="ttname"><a href="classAP__AHRS.html#ae38fa74d7c786afb8bad87d9a2a16bfd">AP_AHRS::get_relative_position_NED_origin</a></div><div class="ttdeci">virtual bool get_relative_position_NED_origin(Vector3f &amp;vec) const </div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00333">AP_AHRS.h:333</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_ab417dbbac7557b327b5ededdaed46c0ea6c6f711f18a620ba39d0215d396d1c59"><div class="ttname"><a href="classAP__ICEngine.html#ab417dbbac7557b327b5ededdaed46c0ea6c6f711f18a620ba39d0215d396d1c59">AP_ICEngine::ICE_START_DELAY</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00040">AP_ICEngine.h:40</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_adb569382b60f51f593d51e94807f47c2"><div class="ttname"><a href="classAP__ICEngine.html#adb569382b60f51f593d51e94807f47c2">AP_ICEngine::rpm_threshold</a></div><div class="ttdeci">AP_Int32 rpm_threshold</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8h_source.html#l00079">AP_ICEngine.h:79</a></div></div>
<div class="ttc" id="SRV__Channel_8h_html"><div class="ttname"><a href="SRV__Channel_8h.html">SRV_Channel.h</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00102">AP_Param.h:102</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Util_html_a973ee89f8eee7af3a4d2a3eb700cbf3c"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a973ee89f8eee7af3a4d2a3eb700cbf3c">AP_HAL::Util::get_soft_armed</a></div><div class="ttdeci">bool get_soft_armed() const </div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00015">Util.h:15</a></div></div>
<div class="ttc" id="classAP__ICEngine_html_a7ff9bcb99673c2fdd18f017902759fdc"><div class="ttname"><a href="classAP__ICEngine.html#a7ff9bcb99673c2fdd18f017902759fdc">AP_ICEngine::engine_control</a></div><div class="ttdeci">bool engine_control(float start_control, float cold_start, float height_delay)</div><div class="ttdef"><b>Definition:</b> <a href="AP__ICEngine_8cpp_source.html#l00266">AP_ICEngine.cpp:266</a></div></div>
<div class="ttc" id="classAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8cpp_source.html#l01195">AP_Param.cpp:1195</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Apr 14 2017 11:51:12 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
